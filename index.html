<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link href="Style21.css" rel="stylesheet">
    </head>
    <body>
      <h1>OffReels</h1>
  <div class="app-container">

    <div class="reel">
      <video 
  id="reel-1" 
  src="My_fav.mp4" 
  loop muted 
  onpointerdown="this.pause()" 
  onpointerup="this.play()">
</video>
      
      <div class="sidebar">
        <div class="icon">â¤ï¸<span>23k</span></div>
        <div class="icon">ğŸ’¬<span>1k</span></div>
        <div class="icon">â†—ï¸<span>Share</span></div>
        <div class="icon">ğŸ”–<span>Save</span></div>
        <div class="icon" onclick="toggleSound('reel-1', this)">ğŸ”‡<span>Mute</span></div>
      </div>
    </div>

    <div class="reel">
      <video 
  id="reel-2" 
  src="My_fav2.mp4" 
  loop muted 
  onpointerdown="this.pause()" 
  onpointerup="this.play()">
</video>
      
      <div class="sidebar">
        <div class="icon">â¤ï¸<span>10k</span></div>
        <div class="icon">ğŸ’¬<span>500</span></div>
        <div class="icon">â†—ï¸<span>Share</span></div>
        <div class="icon">ğŸ”–<span>Save</span></div>
        <div class="icon" onclick="toggleSound('reel-2', this)">ğŸ”‡<span>Mute</span></div>
      </div>
    </div>
    
  <div class="reel">
      <video 
  id="reel-3" 
  src="My_fav3.mp4" 
  autoplay loop muted 
  onpointerdown="this.pause()" 
  onpointerup="this.play()">
</video>
      
      <div class="sidebar">
        <div class="icon">â¤ï¸<span>10k</span></div>
        <div class="icon">ğŸ’¬<span>500</span></div>
        <div class="icon">â†—ï¸<span>Share</span></div>
        <div class="icon">ğŸ”–<span>Save</span></div>
        <div class="icon" onclick="toggleSound('reel-3', this)">ğŸ”‡<span>Mute</span></div>
      </div>
    </div>
  </div>
        <script>
    // 1. THE GLOBAL MEMORY
    let isGlobalMuted = true; 

    // 2. THE BUTTON CLICK LOGIC
    function toggleSound(videoId, btnId) {
      var video = document.getElementById(videoId);
      var buttonElement = document.getElementById(btnId);

      if (isGlobalMuted === true) {
        isGlobalMuted = false; 
        video.muted = false;   
        buttonElement.innerHTML = "ğŸ”Š<span>Unmute</span>";
      } else {
        isGlobalMuted = true;  
        video.muted = true;    
        buttonElement.innerHTML = "ğŸ”‡<span>Mute</span>";
      }
    }

    // 3. THE SMART SCROLLING WATCHER
    const allVideos = document.querySelectorAll('video');

    const watcher = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        
        let videoId = entry.target.id;
        let btnId = videoId.replace('reel', 'mute-btn');
        let buttonElement = document.getElementById(btnId);

        if (entry.isIntersecting) {
          // YES: Video is on screen!
          entry.target.muted = isGlobalMuted;
          
          if (buttonElement) {
            if (isGlobalMuted === true) {
              buttonElement.innerHTML = "ğŸ”‡<span>Mute</span>";
            } else {
              buttonElement.innerHTML = "ğŸ”Š<span>Unmute</span>";
            }
          }
          entry.target.play(); // Let the Watcher press play!
          
        } else {
          // NO: Video scrolled away. 
          entry.target.pause(); // Force it to stop!
          entry.target.muted = true; // Safety catch: force it to mute!
        }
      });
    }, {
      threshold: 0.6 
    });

    allVideos.forEach(video => {
      watcher.observe(video);
    });
  </script>
</html>
